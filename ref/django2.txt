Chipo Django 2
~~~
A chiptune musicdisk disc with Rabenauge.

TODO
~~~
- Make new repo. - DONE
- Strip out code & assets that are not required. - STARTED
- Sort out BSS segment. - DONE
  - And DATA segment. - DONE
  - Need an RODATA segment?
- Add 'toothed' columns. - DONE
- Optimise menu plotting and font plotting code. - DONE
  - Convert smallfont to MODE 9 at runtime? - DONE
  - Also store in ASCII order for simplicity? - DONE
  => TODO: Bold is a bit bodged, ripple hack/effect missing.
- Add scrolltext. - DONE
  => Control codes are triggered on LHS now not RHS.
- Add 3D rendering code for cube. - DONE
- Add 3D cube! - DONE
- Move screen layout to be roughly that of Bodo's WIP. - DONE
- Optimise for 8MHz machines.

https://pdjstone.github.io/arculator-wasm/arculator.html?disc=https://bitshifters.github.io/content/wip/arc-django-2-wip.adf&autoboot=desktop%20filer_run%20adfs::0.$.!Django02


WIP Features
~~~
- Overscan screen?
  - Not currently - 320x256
- Menu at top.
  - Similar to before.
  - Looks like the same font.
- Spinning cube centre LHS of screen.
  - Faces shades of blue.
  - Rendered on top of everything.
- Scrolltext at bottom, 16x16 or 20x20 maybe?
  - Single colour font?
  - Masked on top of background
  - Single pixel scroll?
- Vertically scrolling toothed columns (what to call these?)
  - Five columns
  - 'Teeth' are 16x16
  - Columns are 3x 'teeth' wide
  - Columns overlap by 1x 'teeth' width
  - Columns scroll upwards are different speeds
  - Shades of grey-blue from dark (centre) to light (rhs screen)

Cube visualiser code from Bodo:

    lea mt_Visualizer,a0                                                ; a0 = &mt_Visualizer
    lea scale,a1    ; cube-scale , INC_X, INC_Y, INC_Z                  ; a1 = &cube_deltas
    moveq #4-1,d7   ; number of voices                                  ; d7 = 3
.l:     moveq #15,d0        ;maxvalue 15                                ; d0 = 15
        sub.w (a0)+,d0      ;-#frames/irqs since instrument trigger     ; d0 = 15 - mt_Visualizer[i] (irqs since instrument trigger)
        bpl.s .ok           ;below minvalue?                            ; if > 0 goto .ok
        moveq #0,d0         ;then set to minvalue                       ; d0 = 0
    .ok:
        lsl #1,d0                                                       ; d0 *= 2
        move.w d0,(a1)+     ;poke value                                 ; cube_deltas[i] = d0
        dbf d7,.l                                                       ; if --d7 != 0 goto .1

    move.w scale,d0                                                     ; d0 = cube_deltas[0] (scale)
    mulu #10,d0                                                         ; d0 *= 10
    add.w #START_SIZE,d0 ; add START_SIZE of scale                      ; d0 += START_SIZE
    move.w d0,scale                                                     ; cube_deltas[0] = d0  

Road to Revision
~~~

TODO:

- Splash screen with fade out.
- Hovering masked logo with pixel motion.
  - Add mask colour support to png2arc.py. - DONE (WELL, HACKED)
  - Expand to 8x shifts at runtime.
  - Plot w/ x,y pos.
  - May need to split this into 3 smaller sprites for perf?
- Colours:
  - Uses 32 colours (of course) so need colour split beneath logo.
  - Logo sprite uses 13 colours (including black & white)
  - Need 6 background colours.. :\
  => Ask Bodo if Titus can make a 10 colour version...



- Menu:
  - New layout.
  - New menu small font has no regular/bold. - DONE
  - New menu small font is proportional? - HMMM
  - New menu small font plots different colours over cube... - IGNORE FOR NOW!
  - New colours for the menu, selection & highlight etc.
- Cube:
  - Make smaller. - DONE
  - Remove lighting - DONE
  - Match colours.
  - Check visualiser pulse.
- Sawtooth:
  - Has rounded edges
  - Match colours - DONE
  - Match speeds.
- Scrolltext:
  - New font - DONE, new colour
  - Need text. - MISSING
  - Very slow - needs optimising... DONE
    => 40 words across width of screen.
    => For each word column we read 1x glyph word but write 2x.
    => Read/mask/write 1x into previous column (shifted)
    => Read/mask/write 1x into current column (shifted)
    => 16x for font height.
    => Total read/mask/write = 41*16*lots
  - Could have scroller glyphs on a modest sine wave if we wanted?

- Music playback.
  - Ping ToBach & 4mat - DONE
  - Master volume of each tune.
  - Pause between tunes during autoplay.
- Archie specific:
  - Remove _DJANGO define.
  - Performance on ARM2? <== NEED TO SORT THIS AS A PRIORITY!
    1. Scrolltext - cyan
      => Plot glyphs in one go and deal with edges separately. - DONE
    2. Menu - blue
    3. Cube - red
      => Could combine edge determination & rasterisation.
    4. Logo - magenta
    5. Columns - yellow
    6. Screen clear - green
    => Keyboard scan is also surprisingly high...
      - Rich says use key pressed event and store a mask... DONE!
    => Improve update_3D_scene as well. => DONE
  - Do we need RasterMan or get RasterMan Lite for stablised interrupts.
  - Remove redundant code.
  - Shrink and package etc.
  - Ask Bodo for an app icon?

Scrolltext
~~~
If pre-shifted glyph?
- Load 3x words of glyph.
- Read/mask/store to screen (potentially everything shifted by +1 word for >8 pixels)
- Invert the shift so +7 is offset to the right rather than left.
- Plot entire glyph, don't worry about screen edge just yet.
- Plot slices of glyph on LHS & RHS as required.


Colours
~~~
0 = background
1 - 10 = logo
11 - 15 = columns
COLORBAR0=$122 ; main background
COLORBAR1=$443 ;
COLORBAR2=$654 ;
COLORBAR3=$975 ;
COLORBAR4=$c97 ;
COLORBAR5=$fb8 ;

<TBC>
CUBE COLOURS
; cube-colors	
  dc.w color01,$2a9     ; 0x0001 ; 1
	dc.w color02,$167     ; 0x0010 ; 2
	dc.w color03,$234     ; 0x0011 ; 3

MENU COLOURS
; menu-colors
    dc.w color04,$ac7  - regular menu   ; 0x100 ; 4
    dc.w color05,$cfa  ; under the cube ; 0x101 ; 5
    dc.w color06,$bfa  ; under the cube ; 0x110 ; 6
    dc.w color07,$bf7  ; under the cube ; 0x111 ; 7

                       - selected in this colour
                       - playing flickers between both
    dc.w color12,$191  ; line marker  is set via menu ; 8
    dc.w color13,$3b3  ; line marker under the cube   ; ?
    dc.w color14,$2b3  ; line marker under the cube   ; ?
    dc.w color15,$2b2  ; line marker under the cube   ; ?

SCROLLER COLOUR...
    dc.w color01,$c31  ; scroller color               ; 10
  